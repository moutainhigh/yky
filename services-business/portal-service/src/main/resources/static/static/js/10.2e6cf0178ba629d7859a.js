webpackJsonp([10],{OURg:function(t,e,a){"use strict";var n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("dt-scroll-box",[a("div",{attrs:{slot:"top"},slot:"top"},[a("div",{staticClass:"dt-page-top clearfix"},[a("span",{staticClass:"dt-bread-item"},[t._v("国合项目")]),t._v(" "),a("div",{staticClass:"btn-box fr"},[a("el-button",{staticClass:"dt-btn",on:{click:function(e){t.dialogShow1=!0}}},[t._v("导出模板")]),t._v(" "),a("dt-upload-btn",{staticStyle:{margin:"0 20px"},on:{"upload-success":t.handleUploadSuccess}}),t._v(" "),a("el-button",{staticClass:"dt-btn",on:{click:t.saveData}},[a("i",{staticClass:"iconfont icon-shanchu"}),t._v("保存")])],1)])]),t._v(" "),a("div",{attrs:{slot:"main-content"},slot:"main-content"},[a("div",{staticClass:"cooperation-page"},[a("div",{staticClass:"search-box"},[a("div",{staticClass:"search-item"},[a("span",[t._v("单位名称：")]),t._v(" "),a("el-select",{staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:t.searchData.orgId,callback:function(e){t.$set(t.searchData,"orgId",e)},expression:"searchData.orgId"}},t._l(t.orgOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.label,value:t.id}})}),1)],1),t._v(" "),a("div",{staticClass:"search-item"},[a("span",[t._v("年份：")]),t._v(" "),a("el-select",{staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:t.searchData.year,callback:function(e){t.$set(t.searchData,"year",e)},expression:"searchData.year"}},t._l(t.yearOptions,function(t){return a("el-option",{key:t,attrs:{label:t+"年",value:t}})}),1)],1),t._v(" "),a("div",{staticClass:"search-item"},[a("span",[t._v("月份：")]),t._v(" "),a("el-select",{staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:t.searchData.month,callback:function(e){t.$set(t.searchData,"month",e)},expression:"searchData.month"}},t._l(12,function(t){return a("el-option",{key:t,attrs:{label:t+"月",value:t+""}})}),1)],1),t._v(" "),a("el-button",{staticClass:"dt-btn",staticStyle:{"margin-left":"20px"},on:{click:t.handleSearch}},[a("i",{staticClass:"iconfont icon-shanchu"}),t._v("查询 ")])],1),t._v(" "),a("div",{staticClass:"opt-box"},[a("span",{staticClass:"dt-square-btn",on:{click:t.handleAdd}},[a("i",{staticClass:"el-icon-plus"})]),t._v(" "),a("span",{staticClass:"dt-square-btn",staticStyle:{"margin-left":"10px"},on:{click:t.handleDelete}},[a("i",{staticClass:"el-icon-minus"})])]),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark","header-cell-style":{background:"#F9FAFC",color:"#696969",textAlign:"center"}},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"32"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"项目编号"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proNum,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proNum",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proName","show-overflow-tooltip":"",label:"项目名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proName,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proName",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"cooperationCat",label:"合作类别","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-select",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.cooperationCat,valueRequire:!0,options:t.allTypes},on:{"update:value":function(a){t.$set(e.row,"cooperationCat",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"cooperationOrg",label:"合作单位","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.cooperationOrg,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"cooperationOrg",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proInCharge",label:"项目负责人","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proInCharge,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proInCharge",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proOutlay",label:"项目经费(万)",width:"78","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proOutlay,valueRequire:!0,type:"number"},on:{"update:value":function(a){t.$set(e.row,"proOutlay",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proStartDate",label:"开始时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-date-picker",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proStartDate,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proStartDate",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proEndDate",label:"结束时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-date-picker",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proEndDate,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proEndDate",a)},"handle-change":t.handleValueChange}})]}}])})],1),t._v(" "),a("dt-dialog",{key:"1",attrs:{isShow:t.dialogShow,title:"有未保存的数据，确定继续操作？"},on:{"left-click":t.handleLeftClick,"right-click":function(e){t.dialogShow=!1}}}),t._v(" "),a("dt-dialog",{key:"2",attrs:{isShow:t.dialogShow1,title:"确定导出"+t.activeorgIdName+t.searchData.year+"年"+t.searchData.month+"月的模板？"},on:{"left-click":t.exportModel,"right-click":function(e){t.dialogShow1=!1}}})],1)])])},staticRenderFns:[]};e.a=n},TYVl:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("beyX"),o=a.n(n);for(var l in n)"default"!==l&&function(t){a.d(e,t,function(){return n[t]})}(l);var s=a("OURg");var i=function(t){a("vmzQ")},r=a("VU/8")(o.a,s.a,!1,i,null,null);e.default=r.exports},beyX:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=u(a("mvHQ")),o=u(a("St9J")),l=u(a("FuDR")),s=u(a("QvoL")),i=u(a("Yyxw")),r=u(a("krMA")),c=u(a("ArP1"));function u(t){return t&&t.__esModule?t:{default:t}}var d=["proNum","proName","cooperationCat","cooperationOrg","proInCharge","proOutlay","proStartDate","proEndDate"];e.default={name:"intCooperationProject",components:{DtUploadBtn:o.default,DtTableInput:l.default,DtTableSelect:s.default,DtDialog:i.default,DtTableSelectCas:r.default,DtTableDatePicker:c.default},data:function(){return{pageType:"cooperation",tableData:[],multipleSelection:[],orgOptions:[{id:"1",label:"XXXXXXX验收"}],yearOptions:["2016","2017","2018","2019","2020"],searchData:{orgId:"1",year:"",month:""},allTypes:[{id:"1",label:"国家"},{id:"2",label:"区域"}],tableInputShow:[],unsavedData:[],savedFlag:!0,dialogShow:!1,dialogShow1:!1}},created:function(){var t=this;this.searchData.orgId=this.orgOptions[0].id;var e=new Date;this.searchData.year=e.getFullYear()+"",this.searchData.month=e.getMonth()+1+"";var a=0;this.tableData.forEach(function(e){var n=[];for(var o in e)n.push(!0);t.$set(e,"index",a++),t.tableInputShow.push(n)}),this.initPage()},methods:{initPage:function(){var t=this;this.$http.get("/sys-dict/codes/SRCAT+PROST").then(function(e){var a=e.data;t.stateOptions=a.PROST,t.typeOptions=a.SRCAT,t.getTableData()}).catch(function(t){})},handleSelectionChange:function(t){this.multipleSelection=t},exportModel:function(){console.log("导出模板"),this.dialogShow1=!1},saveData:function(){var t=this;if(this.unsavedData.length){var e=[];this.unsavedData.forEach(function(a){e.push(t.tableData[a])});var a={rows:e};this.$http.post("/srpms-outline/"+this.getUrl(),(0,n.default)(a)).then(function(e){"000000"===e.code&&(t.$message({message:"保存成功！",type:"success"}),t.getTableData())}).catch(function(t){})}else this.$message({message:"您未修改任何数据！",type:"warning"})},getUrl:function(){return this.pageType+"/"+this.searchData.orgId+"/"+this.searchData.year+"/"+this.searchData.month},getTableData:function(){var t=this;this.$http.get("/srpms-outline/"+this.getUrl()).then(function(e){e.data.forEach(function(t){if(t.proCategory){var e=t.proCategory,a=e.substr(1,e.length-2);t.proCategory=a.split(",")}}),t.tableData=e.data||[]}).catch(function(t){})},handleUploadSuccess:function(){this.$message({message:"导入成功！",type:"success"})},formatterType:function(t){var e=this.allTypes.filter(function(e){return String(e.value)===String(t)});return e&&e.length?e[0].label:""},handleAdd:function(){var t={},e=[];d.forEach(function(a){t[a]="",e.push(!1)}),t.index=this.tableData.length,this.tableInputShow.push(e),this.tableData.push(t)},handleDelete:function(){var t=this;this.multipleSelection.length?(this.multipleSelection.forEach(function(e){t.tableData.splice(e.index,1)}),this.multipleTable=[]):this.$message({message:"请选择要删除的项目",type:"warning"})},handleSearch:function(){this.validateSaveFlag()&&this.getTableData()},handleValueChange:function(t){this.savedFlag=!1,-1===this.unsavedData.findIndex(function(e){return e===t})&&this.unsavedData.push(t)},validateSaveFlag:function(){return!!this.savedFlag||(this.dialogShow=!0,!1)},handleLeftClick:function(){this.savedFlag=!0,this.dialogShow=!1,this.unsavedData=[],this.getTableData()}},computed:{activeorgIdName:function(){var t=this,e=this.orgOptions.findIndex(function(e){return e.id===t.searchData.orgId});return-1!==e?this.orgOptions[e].label:""}}}},vmzQ:function(t,e){}});
//# sourceMappingURL=10.2e6cf0178ba629d7859a.js.map