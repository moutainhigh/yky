webpackJsonp([7],{"+Unu":function(e,t){},"2iHJ":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("ynF7"),n=a.n(l);for(var o in l)"default"!==o&&function(e){a.d(t,e,function(){return l[e]})}(o);var s=a("K3eF");var i=function(e){a("+Unu")},r=a("VU/8")(n.a,s.a,!1,i,null,null);t.default=r.exports},K3eF:function(e,t,a){"use strict";var l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("dt-scroll-box",[a("div",{attrs:{slot:"top"},slot:"top"},[a("div",{staticClass:"dt-page-top clearfix"},[a("span",{staticClass:"dt-bread-item"},[e._v("论文")]),e._v(" "),a("div",{staticClass:"btn-box fr"},[a("el-button",{staticClass:"dt-btn",on:{click:function(t){e.dialogShow1=!0}}},[e._v("导出模板")]),e._v(" "),a("dt-upload-btn",{staticStyle:{margin:"0 20px"},on:{"upload-success":e.handleUploadSuccess}}),e._v(" "),a("el-button",{staticClass:"dt-btn",on:{click:e.saveData}},[a("i",{staticClass:"iconfont icon-shanchu"}),e._v("保存")])],1)])]),e._v(" "),a("div",{attrs:{slot:"main-content"},slot:"main-content"},[a("div",{staticClass:"paper-page"},[a("div",{staticClass:"search-box"},[a("div",{staticClass:"search-item"},[a("span",[e._v("单位名称：")]),e._v(" "),a("el-select",{staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:e.searchData.orgId,callback:function(t){e.$set(e.searchData,"orgId",t)},expression:"searchData.orgId"}},e._l(e.orgOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})}),1)],1),e._v(" "),a("div",{staticClass:"search-item"},[a("span",[e._v("年份：")]),e._v(" "),a("el-select",{staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:e.searchData.year,callback:function(t){e.$set(e.searchData,"year",t)},expression:"searchData.year"}},e._l(e.yearOptions,function(e){return a("el-option",{key:e,attrs:{label:e+"年",value:e}})}),1)],1),e._v(" "),a("div",{staticClass:"search-item"},[a("span",[e._v("月份：")]),e._v(" "),a("el-select",{staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:e.searchData.month,callback:function(t){e.$set(e.searchData,"month",t)},expression:"searchData.month"}},e._l(12,function(e){return a("el-option",{key:e,attrs:{label:e+"月",value:e+""}})}),1)],1),e._v(" "),a("el-button",{staticClass:"dt-btn",staticStyle:{"margin-left":"20px"},on:{click:e.handleSearch}},[a("i",{staticClass:"iconfont icon-shanchu"}),e._v("查询 ")])],1),e._v(" "),a("div",{staticClass:"opt-box"},[a("span",{staticClass:"dt-square-btn",on:{click:e.handleAdd}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("span",{staticClass:"dt-square-btn",staticStyle:{"margin-left":"10px"},on:{click:e.handleDelete}},[a("i",{staticClass:"el-icon-minus"})])]),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark","header-cell-style":{background:"#F9FAFC",color:"#696969",textAlign:"center"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"32"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"通讯作者"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dt-table-input",{key:t.$index,attrs:{rowIdx:t.$index,value:t.row.correspondenceAuthor,valueRequire:!0},on:{"update:value":function(a){e.$set(t.row,"correspondenceAuthor",a)},"handle-change":e.handleValueChange}})]}}])}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"第一作者"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dt-table-input",{key:t.$index,attrs:{rowIdx:t.$index,value:t.row.firstAuthor,valueRequire:!0},on:{"update:value":function(a){e.$set(t.row,"firstAuthor",a)},"handle-change":e.handleValueChange}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"paperCat",label:"类别","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dt-table-select",{key:t.$index,attrs:{rowIdx:t.$index,value:t.row.paperCat,valueRequire:!0,options:e.allTypes},on:{"update:value":function(a){e.$set(t.row,"paperCat",a)},"handle-change":e.handleValueChange}})]}}])}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"论文题目"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dt-table-input",{key:t.$index,attrs:{rowIdx:t.$index,value:t.row.paperTitle,valueRequire:!0},on:{"update:value":function(a){e.$set(t.row,"paperTitle",a)},"handle-change":e.handleValueChange}})]}}])}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"期刊名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dt-table-input",{key:t.$index,attrs:{rowIdx:t.$index,value:t.row.journalTitle,valueRequire:!0},on:{"update:value":function(a){e.$set(t.row,"journalTitle",a)},"handle-change":e.handleValueChange}})]}}])}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"发表单位"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dt-table-input",{key:t.$index,attrs:{rowIdx:t.$index,value:t.row.pubicationOrg,valueRequire:!0},on:{"update:value":function(a){e.$set(t.row,"pubicationOrg",a)},"handle-change":e.handleValueChange}})]}}])}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"卷"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dt-table-input",{key:t.$index,attrs:{rowIdx:t.$index,value:t.row.volume,valueRequire:!0},on:{"update:value":function(a){e.$set(t.row,"volume",a)},"handle-change":e.handleValueChange}})]}}])}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"期"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dt-table-input",{key:t.$index,attrs:{rowIdx:t.$index,value:t.row.stage,valueRequire:!0},on:{"update:value":function(a){e.$set(t.row,"stage",a)},"handle-change":e.handleValueChange}})]}}])}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"页码"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dt-table-input",{key:t.$index,attrs:{rowIdx:t.$index,value:t.row.page,valueRequire:!0},on:{"update:value":function(a){e.$set(t.row,"page",a)},"handle-change":e.handleValueChange}})]}}])}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"影响因子"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dt-table-input",{key:t.$index,attrs:{rowIdx:t.$index,value:t.row.influenceFactor,valueRequire:!0},on:{"update:value":function(a){e.$set(t.row,"influenceFactor",a)},"handle-change":e.handleValueChange}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sponsorFlag",label:"期刊性质","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dt-table-select",{key:t.$index,attrs:{rowIdx:t.$index,value:t.row.property,valueRequire:!0,options:e.options1},on:{"update:value":function(a){e.$set(t.row,"property",a)},"handle-change":e.handleValueChange}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sponsorFlag",label:"期刊区域","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dt-table-select",{key:t.$index,attrs:{rowIdx:t.$index,value:t.row.region,valueRequire:!0,options:e.options2},on:{"update:value":function(a){e.$set(t.row,"region",a)},"handle-change":e.handleValueChange}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sponsorFlag",label:"等级","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dt-table-select",{key:t.$index,attrs:{rowIdx:t.$index,value:t.row.level,valueRequire:!0,options:e.options3},on:{"update:value":function(a){e.$set(t.row,"level",a)},"handle-change":e.handleValueChange}})]}}])})],1),e._v(" "),a("dt-dialog",{key:"1",attrs:{isShow:e.dialogShow,title:"有未保存的数据，确定继续操作？"},on:{"left-click":e.handleLeftClick,"right-click":function(t){e.dialogShow=!1}}}),e._v(" "),a("dt-dialog",{key:"2",attrs:{isShow:e.dialogShow1,title:"确定导出"+e.activeorgIdName+e.searchData.year+"年"+e.searchData.month+"月的模板？"},on:{"left-click":e.exportModel,"right-click":function(t){e.dialogShow1=!1}}})],1)])])},staticRenderFns:[]};t.a=l},ynF7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=u(a("mvHQ")),n=u(a("St9J")),o=u(a("FuDR")),s=u(a("QvoL")),i=u(a("Yyxw")),r=u(a("ArP1"));function u(e){return e&&e.__esModule?e:{default:e}}var c=["correspondenceAuthor","firstAuthor","paperCat","paperTitle","journalTitle","volume","stage","page","property","region","level"];t.default={name:"paper",components:{DtUploadBtn:n.default,DtTableInput:o.default,DtTableSelect:s.default,DtDialog:i.default,DtTableDatePicker:r.default},data:function(){return{pageType:"paper",tableData:[],multipleSelection:[],orgOptions:[{id:"1",label:"XXXXXXX验收"}],yearOptions:["2016","2017","2018","2019","2020"],searchData:{orgId:"1",year:"",month:""},allTypes:[{id:"1",label:"主办"},{id:"2",label:"参半"}],stateOptions:[],tableInputShow:[],unsavedData:[],savedFlag:!0,dialogShow:!1,dialogShow1:!1,flagOptions:[{id:"1",label:"是"},{id:"2",label:"否"}],options1:[{id:"1",label:"期刊"},{id:"2",label:"著作"}],options2:[{id:"1",label:"国内"},{id:"2",label:"国外"}],options3:[{id:"1",label:"全国"},{id:"2",label:"省市"},{id:"3",label:"主编"},{id:"4",label:"参编"}]}},created:function(){var e=this;this.searchData.orgId=this.orgOptions[0].id;var t=new Date;this.searchData.year=t.getFullYear()+"",this.searchData.month=t.getMonth()+1+"";var a=0;this.tableData.forEach(function(t){var l=[];for(var n in t)l.push(!0);e.$set(t,"index",a++),e.tableInputShow.push(l)}),this.initPage()},methods:{initPage:function(){var e=this;this.$http.get("/sys-dict/codes/SRCAT+PROST").then(function(t){var a=t.data;e.stateOptions=a.PROST,e.typeOptions=a.SRCAT,e.getTableData()}).catch(function(e){})},handleSelectionChange:function(e){this.multipleSelection=e},exportModel:function(){console.log("导出模板"),this.dialogShow1=!1},saveData:function(){var e=this;if(this.unsavedData.length){var t=[];this.unsavedData.forEach(function(a){t.push(e.tableData[a])});var a={rows:t};this.$http.post("/srpms-outline/"+this.getUrl(),(0,l.default)(a)).then(function(t){"000000"===t.code&&(e.$message({message:"保存成功！",type:"success"}),e.getTableData())}).catch(function(e){})}else this.$message({message:"您未修改任何数据！",type:"warning"})},getUrl:function(){return this.pageType+"/"+this.searchData.orgId+"/"+this.searchData.year+"/"+this.searchData.month},getTableData:function(){var e=this;this.$http.get("/srpms-outline/"+this.getUrl()).then(function(t){t.data.forEach(function(e){if(e.proCategory){var t=e.proCategory,a=t.substr(1,t.length-2);e.proCategory=a.split(",")}}),e.tableData=t.data||[]}).catch(function(e){})},handleUploadSuccess:function(){this.$message({message:"导入成功！",type:"success"})},formatterType:function(e){var t=this.allTypes.filter(function(t){return String(t.value)===String(e)});return t&&t.length?t[0].label:""},handleAdd:function(){var e={},t=[];c.forEach(function(a){e[a]="",t.push(!1)}),e.index=this.tableData.length,this.tableInputShow.push(t),this.tableData.push(e)},handleDelete:function(){var e=this;this.multipleSelection.length?(this.multipleSelection.forEach(function(t){e.tableData.splice(t.index,1)}),this.multipleTable=[]):this.$message({message:"请选择要删除的项目",type:"warning"})},handleSearch:function(){this.validateSaveFlag()&&this.getTableData()},handleValueChange:function(e){this.savedFlag=!1,-1===this.unsavedData.findIndex(function(t){return t===e})&&this.unsavedData.push(e)},validateSaveFlag:function(){return!!this.savedFlag||(this.dialogShow=!0,!1)},handleLeftClick:function(){this.savedFlag=!0,this.dialogShow=!1,this.unsavedData=[],this.getTableData()}},computed:{activeorgIdName:function(){var e=this,t=this.orgOptions.findIndex(function(t){return t.id===e.searchData.orgId});return-1!==t?this.orgOptions[t].label:""}}}}});
//# sourceMappingURL=7.9f2a2236d89f30c19f1a.js.map