webpackJsonp([8],{"5KmL":function(t,e){},"5XZF":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=d(a("mvHQ")),n=d(a("St9J")),i=d(a("FuDR")),o=d(a("QvoL")),s=d(a("Yyxw")),r=d(a("krMA")),c=d(a("ArP1"));function d(t){return t&&t.__esModule?t:{default:t}}var u=["proNum","proName","proCategory","proSourceOrg","proEnterType","proInCharge","proStartDate","proEndDate","proState","proOutlay","proOutlayState"];e.default={name:"newTitle",components:{DtUploadBtn:n.default,DtTableInput:i.default,DtTableSelect:o.default,DtDialog:s.default,DtTableSelectCas:r.default,DtTableDatePicker:c.default},data:function(){return{pageType:"new_title",titleData:{orgId:"",year:"",month:""},tableData:[{proNum:"",proName:"",proCategory:["921876375923593216","921876375923593217","921876375923593218"],proSourceOrg:"",proEnterType:"",proInCharge:"",proStartDate:"",proEndDate:"",proState:"",proOutlay:"",proOutlayState:""}],multipleSelection:[],orgOptions:["测试单位","111"],yearOptions:["2016","2017","2018","2019","2020"],searchData:{orgId:"",year:"",month:""},allTypes:[{id:"1",label:"国家"},{id:"2",label:"区域"}],stateOptions:[],tableInputShow:[],unsavedData:[],savedFlag:!0,dialogShow:!1,dialogShow1:!1,typeOptions:[]}},created:function(){var t=this;this.searchData.orgId=this.orgOptions[0].id,this.titleData.orgId="测试单位";var e=new Date;this.searchData.year=e.getFullYear()+"";var a=0;this.tableData.forEach(function(e){var l=[];for(var n in e)l.push(!0);t.$set(e,"index",a++),t.tableInputShow.push(l)}),this.initPage(),this.typeOptions=[{children:[{children:[{id:"921876375923593218",label:"创新工程"},{id:"921876375927787520",label:"院基科费"},{id:"921876375931981824",label:"校基科费"},{id:"921876375931981825",label:"改革经费"}],id:"921876375923593217",label:"院校级"},{children:[{children:[],id:"921876375931981827",label:"国家科技重大专项"},{children:[],id:"921876375931981828",label:"国家重点研发计划项目"},{children:[],id:"921876375936176128",label:"技术创新引导专项"},{children:[],id:"921876375936176129",label:"重大科学计划"},{children:[],id:"921876375936176130",label:"科技支撑计划"},{children:[],id:"921876375940370432",label:"973计划"},{children:[],id:"921876375940370433",label:"863计划"},{children:[],id:"921876375940370434",label:"基地和人才专项"},{children:[],id:"921876375940370435",label:"基础条件平台"},{children:[],id:"921876375940370436",label:"国际合作项目(科技部)"},{children:[],id:"921876375940370437",label:"其他计划项目"},{children:[],id:"921876375940370438",label:"国家自然科学基金项目"},{children:[],id:"921876375940370439",label:"国家社会科学基金项目"}],id:"921876375931981826",label:"国家级"},{children:[{children:[],id:"921876375944564737",label:"国家卫生健康委项目"},{children:[],id:"921876375944564738",label:"教育部项目"},{children:[],id:"921876375944564739",label:"国家发改委项目"},{children:[],id:"921876375944564740",label:"国家药监局项目"},{children:[],id:"921876375944564741",label:"国家中医药局项目"},{children:[],id:"921876375944564742",label:"中国科协"},{children:[],id:"921876375944564743",label:"北京市自然科学基金"},{children:[],id:"921876375944564744",label:"北京市教委"},{children:[],id:"921876375944564745",label:"北京市科协"},{children:[],id:"921876375948759040",label:"其他部委项目"}],id:"921876375944564736",label:"省部级"},{children:[{children:[],id:"921876375948759042",label:"其他"}],id:"921876375948759041",label:"其他"},{children:[{children:[],id:"921876375948759044",label:"与企业联合项目"}],id:"921876375948759043",label:"横向"}],id:"921876375923593216",label:"科研"}]},methods:{initPage:function(){var t=this;this.$http.get("/sys-dict/codes/SRCAT+PROST").then(function(e){var a=e.data;t.stateOptions=a.PROST,t.typeOptions=a.SRCAT,t.getTableData()}).catch(function(t){})},handleSelectionChange:function(t){this.multipleSelection=t},exportModel:function(){this.$http.get("/srpms-outline/file/"+this.getTitleUrl()).then(function(t){console.log(t)}).catch(function(t){console.log(t)}),this.dialogShow1=!1},saveData:function(){var t=this;if(this.unsavedData.length){var e=[];this.unsavedData.forEach(function(a){e.push(t.tableData[a])});var a={rows:e};this.$http.post("/srpms-outline/"+this.getUrl(),(0,l.default)(a)).then(function(e){"000000"===e.code&&(t.$message({message:"保存成功！",type:"success"}),t.getTableData())}).catch(function(t){})}else this.$message({message:"您未修改任何数据！",type:"warning"})},getUrl:function(){var t="";for(var e in this.searchData)t=(this.searchData[e],t+"/"+this.searchData[e]);return this.pageType+t},getTitleUrl:function(){var t="";for(var e in this.titleData)this.titleData[e]&&(t=t+"/"+this.titleData[e]);return this.pageType+t},getTableData:function(){var t=this;this.$http.get("/srpms-outline/"+this.getUrl()+"/1").then(function(e){e.data.forEach(function(t){if(t.proCategory){var e=t.proCategory,a=e.substr(1,e.length-2);t.proCategory=a.split(",")}}),t.tableData=e.data||[]}).catch(function(t){})},handleUploadSuccess:function(){this.$message({message:"导入成功！",type:"success"})},formatterType:function(t){var e=this.allTypes.filter(function(e){return String(e.value)===String(t)});return e&&e.length?e[0].label:""},handleAdd:function(){var t={},e=[];u.forEach(function(a){t[a]="",e.push(!1)}),t.index=this.tableData.length,this.tableInputShow.push(e),this.tableData.push(t)},handleDelete:function(){var t=this;this.multipleSelection.length?(this.multipleSelection.forEach(function(e){t.tableData.splice(e.index,1)}),this.multipleTable=[]):this.$message({message:"请选择要删除的项目",type:"warning"})},handleSearch:function(){this.validateSaveFlag()&&this.getTableData()},handleValueChange:function(t){this.savedFlag=!1,-1===this.unsavedData.findIndex(function(e){return e===t})&&this.unsavedData.push(t)},validateSaveFlag:function(){return!!this.savedFlag||(this.dialogShow=!0,!1)},handleLeftClick:function(){this.savedFlag=!0,this.dialogShow=!1,this.unsavedData=[],this.getTableData()},getOrg:function(){var t=this,e="";return this.orgOptions.forEach(function(a){String(a.id)===t.titleData.orgId&&(e=a.label)}),e}},computed:{activeorgIdName:function(){var t=this,e=this.orgOptions.findIndex(function(e){return e.id===t.searchData.orgId});return-1!==e?this.orgOptions[e].label:""},exportTitle:function(){var t=this.titleData.year?this.titleData.year+"年":"",e=this.titleData.month?this.titleData.month+"月":"";return"确定导出："+this.getOrg()+t+e+"的模板?"}}}},LFmU:function(t,e,a){"use strict";var l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("dt-scroll-box",[a("div",{attrs:{slot:"top"},slot:"top"},[a("div",{staticClass:"dt-page-top clearfix"},[a("span",{staticClass:"dt-bread-item"},[t._v("新获项目")]),t._v(" "),a("div",{staticClass:"btn-box fr"},[a("el-button",{staticClass:"dt-btn",on:{click:function(e){t.dialogShow1=!0}}},[t._v("下载模板")]),t._v(" "),a("dt-upload-btn",{staticStyle:{margin:"0 20px"},on:{"upload-success":t.handleUploadSuccess}}),t._v(" "),a("el-button",{staticClass:"dt-btn",on:{click:t.saveData}},[a("i",{staticClass:"iconfont icon-shanchu"}),t._v("保存")])],1)])]),t._v(" "),a("div",{attrs:{slot:"main-content"},slot:"main-content"},[a("div",{staticClass:"new-title-page"},[a("h5",{staticClass:"sub-title"},[a("span",{staticClass:"bar"}),t._v("查询条件")]),t._v(" "),a("div",{staticClass:"search-box clearfix"},[a("div",{staticClass:"fl"},[a("div",{staticClass:"table-item pl0"},[a("div",{staticClass:"search-item"},[a("span",[t._v("单位名称：")]),t._v(" "),a("el-select",{staticClass:"dt-select",attrs:{clearable:"",placeholder:"请选择"},model:{value:t.searchData.orgId,callback:function(e){t.$set(t.searchData,"orgId",e)},expression:"searchData.orgId"}},t._l(t.orgOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.label,value:t.id}})}),1)],1),t._v(" "),a("div",{staticClass:"search-item"},[a("span",[t._v("项目编号：")]),t._v(" "),a("el-input",{staticClass:"dt-input",attrs:{placeholder:"请输入"}})],1)]),t._v(" "),a("div",{staticClass:"pl80 table-item"},[a("div",{staticClass:"search-item"},[a("span",[t._v("年份：")]),t._v(" "),a("el-select",{staticClass:"dt-select",attrs:{clearable:"",placeholder:"请选择"},model:{value:t.searchData.year,callback:function(e){t.$set(t.searchData,"year",e)},expression:"searchData.year"}},t._l(t.yearOptions,function(t){return a("el-option",{key:t,attrs:{label:t+"年",value:t}})}),1)],1),t._v(" "),a("div",{staticClass:"search-item"},[a("span",[t._v("项目名称：")]),t._v(" "),a("el-input",{staticClass:"dt-input",attrs:{placeholder:"请输入"}})],1)]),t._v(" "),a("div",{staticClass:"pl80 table-item"},[a("div",{staticClass:"search-item"},[a("span",[t._v("月份：")]),t._v(" "),a("el-select",{staticClass:"dt-select",attrs:{clearable:"",placeholder:"请选择"},model:{value:t.searchData.month,callback:function(e){t.$set(t.searchData,"month",e)},expression:"searchData.month"}},t._l(12,function(t){return a("el-option",{key:t,attrs:{label:t+"月",value:t+""}})}),1)],1),t._v(" "),a("div",{staticClass:"search-item"},[a("span",[t._v("项目负责人：")]),t._v(" "),a("el-input",{staticClass:"dt-input",attrs:{placeholder:"请输入"}})],1)])]),t._v(" "),a("div",{staticClass:"fr search-btn-box"},[a("el-button",{staticClass:"dt-btn",on:{click:t.handleSearch}},[a("i",{staticClass:"iconfont icon-shanchu"}),t._v("查询 ")]),t._v(" "),a("el-button",{staticClass:"dt-btn",staticStyle:{"margin-left":"20px"},on:{click:t.handleSearch}},[a("i",{staticClass:"iconfont icon-shanchu"}),t._v("重置 ")])],1)]),t._v(" "),a("h5",{staticClass:"sub-title"},[a("span",{staticClass:"bar"}),t._v("题录")]),t._v(" "),a("div",{staticClass:"clearfix"},[a("div",{staticClass:"table-title fl"},[a("div",{staticClass:"pl0 table-item"},[a("div",{staticClass:"search-item"},[a("span",[t._v("单位名称：")]),t._v(" "),a("el-select",{staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:t.titleData.orgId,callback:function(e){t.$set(t.titleData,"orgId",e)},expression:"titleData.orgId"}},t._l(t.orgOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.label,value:t.id}})}),1)],1)]),t._v(" "),a("div",{staticClass:"pl80 table-item"},[a("div",{staticClass:"search-item"},[a("span",[t._v("年份：")]),t._v(" "),a("el-select",{ref:"yearTitle",staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:t.titleData.year,callback:function(e){t.$set(t.titleData,"year",e)},expression:"titleData.year"}},t._l(t.yearOptions,function(t){return a("el-option",{key:t,attrs:{label:t+"年",value:t}})}),1)],1)]),t._v(" "),a("div",{staticClass:"pl80 table-item"},[a("div",{staticClass:"search-item"},[a("span",[t._v("月份：")]),t._v(" "),a("el-select",{ref:"monthTitle",staticClass:"dt-select",attrs:{clearable:"",placeholder:"请选择"},model:{value:t.titleData.month,callback:function(e){t.$set(t.titleData,"month",e)},expression:"titleData.month"}},t._l(12,function(t){return a("el-option",{key:t,attrs:{label:t+"月",value:t+""}})}),1)],1)])]),t._v(" "),a("div",{staticClass:"fr opt-box"},[a("span",{staticClass:"dt-square-btn mini",on:{click:t.handleAdd}},[a("i",{staticClass:"el-icon-plus"})]),t._v(" "),a("span",{staticClass:"dt-square-btn mini",staticStyle:{"margin-left":"10px"},on:{click:t.handleDelete}},[a("i",{staticClass:"el-icon-minus"})])])]),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark","header-cell-style":{background:"#F9FAFC",color:"#696969",textAlign:"center"}},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"32"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"项目编号"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proNum,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proNum",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proName","show-overflow-tooltip":"",label:"项目名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proName,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proName",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proCategory",label:"项目类别","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-select-cas",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proCategory,options:t.typeOptions},on:{"update:value":function(a){t.$set(e.row,"proCategory",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proSourceOrg",label:"来源机构","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proSourceOrg,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proSourceOrg",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proEnterType",label:"参与形式","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-select",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proEnterType,valueRequire:!0,options:t.allTypes},on:{"update:value":function(a){t.$set(e.row,"proEnterType",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proInCharge",label:"负责人工号","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proInCharge,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proInCharge",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proInCharge",label:"负责人","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proInCharge,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proInCharge",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proStartDate",label:"开始时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-date-picker",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proStartDate,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proStartDate",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proEndDate",label:"结束时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-date-picker",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proEndDate,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proEndDate",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proState",width:"78",label:"状态","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-select",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proState,valueRequire:!0,options:t.stateOptions},on:{"update:value":function(a){t.$set(e.row,"proState",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proOutlay",label:"总经费(万)",width:"78","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proOutlay,valueRequire:!0,type:"number"},on:{"update:value":function(a){t.$set(e.row,"proOutlay",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proOutlayState",label:"到位经费(万)",width:"120px","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proOutlayState,valueRequire:!0,type:"number"},on:{"update:value":function(a){t.$set(e.row,"proOutlayState",a)},"handle-change":t.handleValueChange}})]}}])})],1),t._v(" "),a("dt-dialog",{key:"1",attrs:{isShow:t.dialogShow,title:"有未保存的数据，确定继续操作？"},on:{"left-click":t.handleLeftClick,"right-click":function(e){t.dialogShow=!1}}}),t._v(" "),a("dt-dialog",{key:"2",attrs:{isShow:t.dialogShow1,title:t.exportTitle},on:{"left-click":t.exportModel,"right-click":function(e){t.dialogShow1=!1}}})],1)])])},staticRenderFns:[]};e.a=l},wc6H:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("5XZF"),n=a.n(l);for(var i in l)"default"!==i&&function(t){a.d(e,t,function(){return l[t]})}(i);var o=a("LFmU");var s=function(t){a("5KmL")},r=a("VU/8")(n.a,o.a,!1,s,null,null);e.default=r.exports}});
//# sourceMappingURL=8.dd036739e0568346d3e4.js.map