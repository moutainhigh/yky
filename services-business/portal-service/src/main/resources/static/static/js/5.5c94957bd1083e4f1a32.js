webpackJsonp([5],{Tx80:function(t,e){},dbO5:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("xm8G"),l=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);var i=a("vz8h");var s=function(t){a("Tx80")},r=a("VU/8")(l.a,i.a,!1,s,null,null);e.default=r.exports},vz8h:function(t,e,a){"use strict";var n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("dt-scroll-box",[a("div",{attrs:{slot:"top"},slot:"top"},[a("div",{staticClass:"dt-page-top clearfix"},[a("span",{staticClass:"dt-bread-item"},[t._v("成果鉴定")]),t._v(" "),a("div",{staticClass:"btn-box fr"},[a("el-button",{staticClass:"dt-btn",on:{click:function(e){t.dialogShow1=!0}}},[t._v("导出模板")]),t._v(" "),a("dt-upload-btn",{staticStyle:{margin:"0 20px"},on:{"upload-success":t.handleUploadSuccess}}),t._v(" "),a("el-button",{staticClass:"dt-btn",on:{click:t.saveData}},[a("i",{staticClass:"iconfont icon-shanchu"}),t._v("保存")])],1)])]),t._v(" "),a("div",{attrs:{slot:"main-content"},slot:"main-content"},[a("div",{staticClass:"result-transform-page"},[a("div",{staticClass:"search-box"},[a("div",{staticClass:"search-item"},[a("span",[t._v("单位名称：")]),t._v(" "),a("el-select",{staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:t.searchData.orgId,callback:function(e){t.$set(t.searchData,"orgId",e)},expression:"searchData.orgId"}},t._l(t.orgOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.label,value:t.id}})}),1)],1),t._v(" "),a("div",{staticClass:"search-item"},[a("span",[t._v("年份：")]),t._v(" "),a("el-select",{staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:t.searchData.year,callback:function(e){t.$set(t.searchData,"year",e)},expression:"searchData.year"}},t._l(t.yearOptions,function(t){return a("el-option",{key:t,attrs:{label:t+"年",value:t}})}),1)],1),t._v(" "),a("div",{staticClass:"search-item"},[a("span",[t._v("月份：")]),t._v(" "),a("el-select",{staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:t.searchData.month,callback:function(e){t.$set(t.searchData,"month",e)},expression:"searchData.month"}},t._l(12,function(t){return a("el-option",{key:t,attrs:{label:t+"月",value:t+""}})}),1)],1),t._v(" "),a("el-button",{staticClass:"dt-btn",staticStyle:{"margin-left":"20px"},on:{click:t.handleSearch}},[a("i",{staticClass:"iconfont icon-shanchu"}),t._v("查询 ")])],1),t._v(" "),a("div",{staticClass:"opt-box"},[a("span",{staticClass:"dt-square-btn",on:{click:t.handleAdd}},[a("i",{staticClass:"el-icon-plus"})]),t._v(" "),a("span",{staticClass:"dt-square-btn",staticStyle:{"margin-left":"10px"},on:{click:t.handleDelete}},[a("i",{staticClass:"el-icon-minus"})])]),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark","header-cell-style":{background:"#F9FAFC",color:"#696969",textAlign:"center"}},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"32"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"项目编号"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proNum,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proNum",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proName","show-overflow-tooltip":"",label:"项目名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proName,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proName",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"completionOrg",label:"第一完成单位","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.completionOrg,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"completionOrg",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"completionPerson",label:"完成人","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.completionPerson,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"completionPerson",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"taskSource",label:"任务来源","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-select",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.taskSource,valueRequire:!0,options:t.allTypes},on:{"update:value":function(a){t.$set(e.row,"taskSource",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"identifyOrg",label:"组织鉴定(验收)单位",width:"200px","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.identifyOrg,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"identifyOrg",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"identifyWay",label:"鉴定(验收)形式","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-select",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.identifyWay,valueRequire:!0,options:t.allTypes},on:{"update:value":function(a){t.$set(e.row,"identifyWay",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"contractSigningYear",label:"鉴定(验收)时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-date-picker",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.contractSigningYear,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"contractSigningYear",a)},"handle-change":t.handleValueChange}})]}}])})],1),t._v(" "),a("dt-dialog",{key:"1",attrs:{isShow:t.dialogShow,title:"有未保存的数据，确定继续操作？"},on:{"left-click":t.handleLeftClick,"right-click":function(e){t.dialogShow=!1}}}),t._v(" "),a("dt-dialog",{key:"2",attrs:{isShow:t.dialogShow1,title:"确定导出"+t.activeorgIdName+t.searchData.year+"年"+t.searchData.month+"月的模板？"},on:{"left-click":t.exportModel,"right-click":function(e){t.dialogShow1=!1}}})],1)])])},staticRenderFns:[]};e.a=n},xm8G:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=c(a("mvHQ")),l=c(a("St9J")),o=c(a("FuDR")),i=c(a("QvoL")),s=c(a("Yyxw")),r=c(a("ArP1"));function c(t){return t&&t.__esModule?t:{default:t}}var u=["proNum","proName","completionOrg","completionPerson","taskSource","identifyOrg","identifyWay","contractSigningYear"];e.default={name:"resultTest",components:{DtUploadBtn:l.default,DtTableInput:o.default,DtTableSelect:i.default,DtDialog:s.default,DtTableDatePicker:r.default},data:function(){return{pageType:"result_identify",tableData:[],multipleSelection:[],orgOptions:[{id:"1",label:"XXXXXXX验收"}],yearOptions:["2016","2017","2018","2019","2020"],searchData:{orgId:"1",year:"",month:""},allTypes:[{id:"1",label:"国家"},{id:"2",label:"区域"}],tableInputShow:[],unsavedData:[],savedFlag:!0,dialogShow:!1,dialogShow1:!1}},created:function(){var t=this;this.searchData.orgId=this.orgOptions[0].id;var e=new Date;this.searchData.year=e.getFullYear()+"",this.searchData.month=e.getMonth()+1+"";var a=0;this.tableData.forEach(function(e){var n=[];for(var l in e)n.push(!0);t.$set(e,"index",a++),t.tableInputShow.push(n)}),this.initPage()},methods:{initPage:function(){var t=this;this.$http.get("/sys-dict/codes/SRCAT+PROST").then(function(e){var a=e.data;t.stateOptions=a.PROST,t.typeOptions=a.SRCAT,t.getTableData()}).catch(function(t){})},handleSelectionChange:function(t){this.multipleSelection=t},exportModel:function(){console.log("导出模板"),this.dialogShow1=!1},saveData:function(){var t=this;if(this.unsavedData.length){var e=[];this.unsavedData.forEach(function(a){e.push(t.tableData[a])});var a={rows:e};this.$http.post("/srpms-outline/"+this.getUrl(),(0,n.default)(a)).then(function(e){"000000"===e.code&&(t.$message({message:"保存成功！",type:"success"}),t.getTableData())}).catch(function(t){})}else this.$message({message:"您未修改任何数据！",type:"warning"})},getUrl:function(){return this.pageType+"/"+this.searchData.orgId+"/"+this.searchData.year+"/"+this.searchData.month},getTableData:function(){var t=this;this.$http.get("/srpms-outline/"+this.getUrl()).then(function(e){e.data.forEach(function(t){if(t.proCategory){var e=t.proCategory,a=e.substr(1,e.length-2);t.proCategory=a.split(",")}}),t.tableData=e.data||[]}).catch(function(t){})},handleUploadSuccess:function(){this.$message({message:"导入成功！",type:"success"})},formatterType:function(t){var e=this.allTypes.filter(function(e){return String(e.value)===String(t)});return e&&e.length?e[0].label:""},handleAdd:function(){var t={},e=[];u.forEach(function(a){t[a]="",e.push(!1)}),t.index=this.tableData.length,this.tableInputShow.push(e),this.tableData.push(t)},handleDelete:function(){var t=this;this.multipleSelection.length?(this.multipleSelection.forEach(function(e){t.tableData.splice(e.index,1)}),this.multipleTable=[]):this.$message({message:"请选择要删除的项目",type:"warning"})},handleSearch:function(){this.validateSaveFlag()&&this.getTableData()},handleValueChange:function(t){this.savedFlag=!1,-1===this.unsavedData.findIndex(function(e){return e===t})&&this.unsavedData.push(t)},validateSaveFlag:function(){return!!this.savedFlag||(this.dialogShow=!0,!1)},handleLeftClick:function(){this.savedFlag=!0,this.dialogShow=!1,this.unsavedData=[],this.getTableData()}},computed:{activeorgIdName:function(){var t=this,e=this.orgOptions.findIndex(function(e){return e.id===t.searchData.orgId});return-1!==e?this.orgOptions[e].label:""}}}}});
//# sourceMappingURL=5.5c94957bd1083e4f1a32.js.map