webpackJsonp([11],{"j/cT":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,l=c(a("bOdI")),o=c(a("mvHQ")),s=c(a("St9J")),i=c(a("FuDR")),r=c(a("Yyxw"));function c(t){return t&&t.__esModule?t:{default:t}}var u=["proNum","proName","completionOrg","completionPerson","awardName","awardCat","awardLevel"];e.default={name:"award",components:{DtUploadBtn:s.default,DtTableInput:i.default,DtDialog:r.default},data:function(){return{pageType:"award",tableData:[],multipleSelection:[],orgOptions:[{id:"1",label:"XXXXXXX验收"}],yearOptions:["2016","2017","2018","2019","2020"],searchData:{orgId:"1",year:"",month:""},tableInputShow:[],unsavedData:[],savedFlag:!0,dialogShow:!1,dialogShow1:!1}},created:function(){var t=this;this.searchData.orgId=this.orgOptions[0].id;var e=new Date;this.searchData.year=e.getFullYear()+"",this.searchData.month=e.getMonth()+1+"",this.tableData.forEach(function(e){var a=[];for(var n in e)a.push(!0);t.tableInputShow.push(a)});var a=0;this.tableData.forEach(function(e){var n=[];for(var l in e)n.push(!0);t.$set(e,"index",a++),t.tableInputShow.push(n)}),this.initPage()},methods:(n={initPage:function(){var t=this;this.$http.get("/sys-dict/codes/SRCAT+PROST").then(function(e){var a=e.data;t.stateOptions=a.PROST,t.typeOptions=a.SRCAT,t.getTableData()}).catch(function(t){})},getUrl:function(){return this.pageType+"/"+this.searchData.orgId+"/"+this.searchData.year+"/"+this.searchData.month},getTableData:function(){var t=this;this.$http.get("/srpms-outline/"+this.getUrl()).then(function(e){t.tableData=e.data||[]}).catch(function(t){})},handleAdd:function(){var t={},e=[];u.forEach(function(a){t[a]="",e.push(!1)}),t.index=this.tableData.length,this.tableInputShow.push(e),this.tableData.push(t)},handleDelete:function(){var t=this;this.multipleSelection.length?(this.multipleSelection.forEach(function(e){t.tableData.splice(e.index,1)}),this.multipleTable=[]):this.$message({message:"请选择要删除的项目",type:"warning"})},handleSelectionChange:function(t){this.multipleSelection=t},exportModel:function(){console.log("导出模板"),this.dialogShow1=!1},saveData:function(){var t=this;if(this.unsavedData.length){var e=[];this.unsavedData.forEach(function(a){e.push(t.tableData[a])});var a={rows:e};console.log((0,o.default)(a)),this.$http.post("/srpms-outline/"+this.getUrl(),(0,o.default)(a)).then(function(e){"000000"===e.code&&(t.$message({message:"保存成功！",type:"success"}),t.getTableData())}).catch(function(t){})}else this.$message({message:"您未修改任何数据！",type:"warning"})},handleUploadSuccess:function(){this.$message({message:"导入成功！",type:"success"})},formatterType:function(t){var e=this.allTypes.filter(function(e){return String(e.value)===String(t)});return e&&e.length?e[0].label:""}},(0,l.default)(n,"handleAdd",function(){var t={},e=[];u.forEach(function(a){t[a]="",e.push(!1)}),t.index=this.tableData.length,this.tableInputShow.push(e),this.tableData.push(t)}),(0,l.default)(n,"handleDelete",function(){var t=this;this.multipleSelection.length?(this.multipleSelection.forEach(function(e){t.tableData.splice(e.index,1)}),this.multipleTable=[]):this.$message({message:"请选择要删除的项目",type:"warning"})}),(0,l.default)(n,"handleSearch",function(){this.validateSaveFlag()&&this.getTableData()}),(0,l.default)(n,"handleValueChange",function(t){this.savedFlag=!1,-1===this.unsavedData.findIndex(function(e){return e===t})&&this.unsavedData.push(t)}),(0,l.default)(n,"validateSaveFlag",function(){return!!this.savedFlag||(this.dialogShow=!0,!1)}),(0,l.default)(n,"handleLeftClick",function(){this.savedFlag=!0,this.dialogShow=!1,this.handleSearch()}),n),computed:{activeorgIdName:function(){var t=this,e=this.orgOptions.findIndex(function(e){return e.id===t.searchData.orgId});return-1!==e?this.orgOptions[e].label:""}}}},mo6z:function(t,e){},"s+SI":function(t,e,a){"use strict";var n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("dt-scroll-box",[a("div",{attrs:{slot:"top"},slot:"top"},[a("div",{staticClass:"top clearfix"},[a("span",{staticClass:"dt-bread-item"},[t._v("奖励")]),t._v(" "),a("div",{staticClass:"btn-box fr"},[a("el-button",{staticClass:"dt-btn",on:{click:function(e){t.dialogShow1=!0}}},[t._v("导出模板")]),t._v(" "),a("dt-upload-btn",{staticStyle:{margin:"0 20px"},on:{"upload-success":t.handleUploadSuccess}}),t._v(" "),a("el-button",{staticClass:"dt-btn",on:{click:t.saveData}},[a("i",{staticClass:"iconfont icon-shanchu"}),t._v("保存")])],1)])]),t._v(" "),a("div",{attrs:{slot:"main-content"},slot:"main-content"},[a("div",{staticClass:"award-page"},[a("div",{staticClass:"search-box"},[a("div",{staticClass:"search-item"},[a("span",[t._v("单位名称：")]),t._v(" "),a("el-select",{staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:t.searchData.orgId,callback:function(e){t.$set(t.searchData,"orgId",e)},expression:"searchData.orgId"}},t._l(t.orgOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.label,value:t.id}})}),1)],1),t._v(" "),a("div",{staticClass:"search-item"},[a("span",[t._v("年份：")]),t._v(" "),a("el-select",{staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:t.searchData.year,callback:function(e){t.$set(t.searchData,"year",e)},expression:"searchData.year"}},t._l(t.yearOptions,function(t){return a("el-option",{key:t,attrs:{label:t+"年",value:t}})}),1)],1),t._v(" "),a("div",{staticClass:"search-item"},[a("span",[t._v("月份：")]),t._v(" "),a("el-select",{staticClass:"dt-select",attrs:{placeholder:"请选择"},model:{value:t.searchData.month,callback:function(e){t.$set(t.searchData,"month",e)},expression:"searchData.month"}},t._l(12,function(t){return a("el-option",{key:t,attrs:{label:t+"月",value:t}})}),1)],1),t._v(" "),a("el-button",{staticClass:"dt-btn",staticStyle:{"margin-left":"20px"},on:{click:t.handleSearch}},[a("i",{staticClass:"iconfont icon-shanchu"}),t._v("查询 ")])],1),t._v(" "),a("div",{staticClass:"opt-box"},[a("span",{staticClass:"dt-square-btn",on:{click:t.handleAdd}},[a("i",{staticClass:"el-icon-plus"})]),t._v(" "),a("span",{staticClass:"dt-square-btn",staticStyle:{"margin-left":"10px"},on:{click:t.handleDelete}},[a("i",{staticClass:"el-icon-minus"})])]),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark","header-cell-style":{background:"#F9FAFC",color:"#696969",textAlign:"center"}},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"32"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"项目编码"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proNum,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proNum",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"proName","show-overflow-tooltip":"",label:"项目名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.proName,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"proName",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"completionOrg",label:"完成单位","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.completionOrg,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"completionOrg",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"completionPerson",label:"主要完成人","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.completionPerson,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"completionPerson",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"audit",label:"奖项类别","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.awardCat,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"awardCat",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"awardName",label:"奖项名称","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.awardName,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"awardName",a)},"handle-change":t.handleValueChange}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"style",label:"奖项等级","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dt-table-input",{key:e.$index,attrs:{rowIdx:e.$index,value:e.row.awardLevel,valueRequire:!0},on:{"update:value":function(a){t.$set(e.row,"awardLevel",a)},"handle-change":t.handleValueChange}})]}}])})],1),t._v(" "),a("dt-dialog",{key:"1",attrs:{isShow:t.dialogShow,title:"有未保存的数据，确定继续操作？"},on:{"left-click":t.handleLeftClick,"right-click":function(e){t.dialogShow=!1}}}),t._v(" "),a("dt-dialog",{key:"2",attrs:{isShow:t.dialogShow1,title:"确定导出"+t.activeorgIdName+t.searchData.year+"年"+t.searchData.month+"月的模板？"},on:{"left-click":t.exportModel,"right-click":function(e){t.dialogShow1=!1}}})],1)])])},staticRenderFns:[]};e.a=n},zQek:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("j/cT"),l=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);var s=a("s+SI");var i=function(t){a("mo6z")},r=a("VU/8")(l.a,s.a,!1,i,null,null);e.default=r.exports}});
//# sourceMappingURL=11.c4b150f8309af2e69c4a.js.map